<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å©šå®´åº§ä½æŸ¥è©¢èˆ‡å ±åˆ°</title>
<style>
  body { font-family: 'Segoe UI', sans-serif; padding: 2rem; text-align: center; background-color: #fffaf8; color: #333; }
  h1 { font-size: 2rem; color: #c94e4e; }
  input, button, select { padding: 0.6rem; font-size: 1.1rem; margin: 0.5rem; border-radius: 8px; border: 1px solid #ccc; width: 80%; max-width: 300px; }
  button { background-color: #c94e4e; color: white; border: none; cursor: pointer; }
  button:hover { background-color: #a83838; }
  .result { margin-top: 1.5rem; font-size: 1.3rem; font-weight: bold; color: #c94e4e; }
  .select-guest { margin-top: 1rem; }
  .select-guest select { font-size: 1rem; padding: 0.4rem; }
  .table-map { margin-top: 2rem; }
  .pdf-wrapper { width: 100%; max-width: 900px; height: 70vh; margin: 1rem auto 0; border-radius: 14px; overflow: hidden; box-shadow: 0 6px 18px rgba(0,0,0,0.15); background: #fff; }
  .pdf-wrapper iframe { width: 100%; height: 100%; border: none; }
</style>
</head>
<body>

<h1>ğŸ‰ å©šå®´åº§ä½æŸ¥è©¢èˆ‡å ±åˆ° ğŸ‰</h1>
<p>è«‹è¼¸å…¥æ‚¨çš„å§“å</p>

<input type="text" id="queryInput" placeholder="å§“å" maxlength="10" />
<button onclick="lookupSeat()">æŸ¥è©¢</button>

<div class="result" id="result"></div>
<div class="select-guest" id="guestSelect"></div>

<div class="table-map">
  <h2>ğŸ“ åº§ä½å¹³é¢åœ–</h2>
  <div class="pdf-wrapper">
    <iframe src="https://drive.google.com/file/d/1zexy5__MeuZsXD4d3t2Sk2fvprYNGVjB/preview" loading="lazy" allowfullscreen></iframe>
  </div>
</div>

<!-- éš±è— iframe ç”¨ä¾†æäº¤ form -->
<iframe name="checkinFrame" style="display:none;"></iframe>

<script>
const webAppUrl = 'https://script.google.com/macros/s/AKfycbzXmIzPLwBDP-0Mq5MpEa_07wFZqPqtoWUiKAu-qTMVEkhM_Uo6a9exzTqAn_0XJwXL/exec';
const guests = [
  // 2è™Ÿæ¡Œ - å¥³æ–¹è¦ªæˆš
  { name: "é™³ç§‹ç‡•", table: "2" },
  { name: "ç›§æ°¸è£•", table: "2" },
  { name: "åŠ‰æœ¨æ—", table: "2" },
  { name: "ç›§æ˜­å¨¥", table: "2" },
  { name: "æ›¾æœˆéœ", table: "2" },
  { name: "é™³ç´ å¬Œ", table: "2" },
  { name: "è¬å°å›", table: "2" },

  // 3è™Ÿæ¡Œ - å¥³æ–¹è¦ªæˆš
  { name: "é™³ç´ å‹¤", table: "3" },
  { name: "æœ±ç¢§èŠ¬", table: "3" },
  { name: "æœ±ç‘æ‰", table: "3" },
  { name: "ç¾…å¤æ£®", table: "3" },
  { name: "æœ±æ²›å³°", table: "3" },

  // 5è™Ÿæ¡Œ - å¥³æ–¹è¦ªæˆš
  { name: "é„­æ­£é›„", table: "5" },
  { name: "é„­æƒ æ·‘", table: "5" },
  { name: "é„­æ­£æ–‡", table: "5" },
  { name: "å»–æ™ºèƒ½", table: "5" },
  { name: "é„­æ˜‡å‚‘", table: "5" },
  { name: "é»ƒç´ å­Ÿ", table: "5" },

  // 6è™Ÿæ¡Œ - å¥³æ–¹è¦ªæˆš
  { name: "éº—è¶³å§‘å§‘", table: "6" },
  { name: "é˜¿æ·µä¼¯çˆ¶", table: "6" },

  // 7è™Ÿæ¡Œ - è¦ªå®¶å¥½å‹
  { name: "é»ƒå´‡æµ·", table: "7" },
  { name: "ç¿å‰ç¿”", table: "7" },
  { name: "ç¿å‰æ™º", table: "7" },
  { name: "æ—å³°æ¨™", table: "7" },
  { name: "å¼µè‚²ä»", table: "7" },
  { name: "ç¿èŒ‚é¾", table: "7" },
  { name: "æ–½å»ºå®‰", table: "7" },

  // 8è™Ÿæ¡Œ - è¦ªå®¶å¥½å‹
  { name: "å®‹æ¬Šç‡", table: "8" },
  { name: "è•­ç‡ˆç…Œ", table: "8" },
  { name: "å®‹å®¶åš´", table: "8" },
  { name: "ç‹è‚²æ–‡", table: "8" },
  { name: "ç†Šæ˜æ•", table: "8" },
  { name: "ä¾¯æ™Ÿå‹›", table: "8" },
  { name: "æ¸¸è²´å„’", table: "8" },

  // 9è™Ÿæ¡Œ - è¦ªå®¶å¥½å‹
  { name: "ææ–‡æˆ", table: "9" },
  { name: "æ—æ˜è¼", table: "9" },
  { name: "é™³ä¸­é™½", table: "9" },
  { name: "ç‹å­æ–‡", table: "9" },
  { name: "é»ƒå¤©ç¦", table: "9" },
  { name: "é»ƒåœ‹æ˜Œ", table: "9" },
  { name: "é€£æµ©é›²", table: "9" },

  // 10è™Ÿæ¡Œ - å¥³æ–¹è¦ªæˆš
  { name: "ç‹å®å“²", table: "10" },
  { name: "ç‹ç‘å‘ˆ", table: "10" },
  { name: "ç‹å­ä¿®", table: "10" },
  { name: "å¼µéƒ¡èŠ³", table: "10" },

  // 11è™Ÿæ¡Œ - å¥³æ–¹è¦ªæˆš
  { name: "æ˜¥æ¡ƒå§‘å§‘", table: "11" },
  { name: "æ·‘ç²å§‘å§‘", table: "11" },
  { name: "é‚±å‹å¤", table: "11" },

  // 12è™Ÿæ¡Œ - å¥³æ–¹è¦ªæˆš
  { name: "é„­è€˜æ½”", table: "12" },
  { name: "Miffy", table: "12" },
  { name: "Hannah", table: "12" },
  { name: "é„­æ˜‡æ˜Œ", table: "12" },
  { name: "é„­è€˜å–¬", table: "12" },
  { name: "èŒƒèŠ·ç‘ˆ", table: "12" },
  { name: "é¾åº­è™¹", table: "12" },
  { name: "é„­é‡è¦", table: "12" },

  // 13è™Ÿæ¡Œ - å¥³æ–¹å¥½å‹
  { name: "é™³æŸ”å®‰", table: "13" },
  { name: "é„­å“æ¬£", table: "13" },
  { name: "è‘‰å®‡æŸ”", table: "13" },
  { name: "è˜‡å„€å¨Ÿ", table: "13" },
  { name: "é‚±å¦ç­‘", table: "13" },
  { name: "åŠ‰æ¬£å¯§", table: "13" },

  // 14è™Ÿæ¡Œ - å¥³æ–¹å¥½å‹
  { name: "é»ƒæ”¿æ£¨", table: "14" },
  { name: "å»–æ€¡è‡»", table: "14" },
  { name: "èŠç’¨ç¾½", table: "14" },
  { name: "é™³å»ºå®‰", table: "14" },
  { name: "å»–æ™ºè‹±", table: "14" },
  { name: "æ²ˆæ˜¥ç§€", table: "14" },
  { name: "å³ä¾ç²", table: "14" },
  { name: "ç‹æ·³æ…§", table: "14" },
  { name: "æ¸¸ä¾ç©", table: "14" },
  { name: "é™³å˜‰å®", table: "14" },
  { name: "å‘¨å®‡çœ‰", table: "14" },

  // 15è™Ÿæ¡Œ - è¦ªå®¶åŒå­¸
  { name: "è¬å…†é’", table: "15" },
  { name: "å®æ—Œ", table: "15" },
  { name: "é‚±æ¬½æº", table: "15" },
  { name: "å½­å¿ å±±", table: "15" },
  { name: "è”¡åœ‹æ–‡", table: "15" },
  { name: "é™³æ–‡åŠ©", table: "15" },
  { name: "ç‘éˆ¦", table: "15" },

  // 16è™Ÿæ¡Œ - è¦ªå®¶å¥½å‹ï¼ˆè²¡å„„ï¼‰
  { name: "å³å­£ç©", table: "16" },
  { name: "é™³æ–‡æ¨™", table: "16" },
  { name: "ä¾¯æ™ºè³¢", table: "16" },
  { name: "è¶™é€¸ç¥¥", table: "16" },
  { name: "è³´ä¿Šæ†²", table: "16" },
  { name: "åŠ‰ä½³å®™", table: "16" },

  // 17è™Ÿæ¡Œ - ç”·æ–¹è¦ªæˆš
  { name: "å¤§ä¼¯å…’å­", table: "17" },
  { name: "äºŒä¼¯å…’å­", table: "17" },
  { name: "å¤§ä¼¯å¥³å…’", table: "17" },
  { name: "äºŒå§‘å§‘", table: "17" },
  { name: "äºŒä¼¯", table: "17" },
  { name: "äºŒå§‘å§‘å…’å­", table: "17" },
  { name: "äºŒä¼¯æ¯", table: "17" },

  // 18è™Ÿæ¡Œ - ç”·æ–¹è¦ªæˆš
  { name: "å¤§å§‘å§‘", table: "18" },
  { name: "å¤§å§‘ä¸ˆ", table: "18" },
  { name: "å¤§å§‘å§‘å¤§å…’å­", table: "18" },
  { name: "å¤§å§‘å§‘äºŒå…’å­", table: "18" },
  { name: "ä¿æ¯", table: "18" },
  { name: "å¦¹å¦¹", table: "18" },

  // 19è™Ÿæ¡Œ - ç”·æ–¹åŒå­¸
  { name: "å‚…ç­±æ¶µ", table: "19" },
  { name: "å¼µè€€å‹", table: "19" },
  { name: "å³æ˜Œä»»", table: "19" },
  { name: "é™³æ¡‚è±ª", table: "19" },
  { name: "æ¥Šè‚²å˜‰", table: "19" },
  { name: "å­«ä¹ƒå©·", table: "19" },

  // 20è™Ÿæ¡Œ - ç”·æ–¹åŒå­¸
  { name: "åŠ‰åœƒèª", table: "20" },
  { name: "åŠ‰å† å»·", table: "20" },
  { name: "è¬å‰å¼˜", table: "20" },
  { name: "ç¨‹ä¸–è˜", table: "20" },
  { name: "é™³æŸå®‰", table: "20" },
  { name: "é™³å½¥è", table: "20" },
  { name: "ç‹éœ†éˆ", table: "20" },

  // 21è™Ÿæ¡Œ - ç”·æ–¹åŒå­¸
  { name: "é»ƒå½¬é€¢", table: "21" },
  { name: "é»ƒå¥éŠ˜", table: "21" },
  { name: "å¼µæ™ç¦", table: "21" },
  { name: "å°é˜¿å§¨", table: "21" },
  { name: "å°å§¨ä¸ˆ", table: "21" },
  { name: "æ¥Šæ˜“å¡", table: "21" },
  { name: "æ¥Šç³éˆ", table: "21" },

  // 22è™Ÿæ¡Œ - æ–°äººå¥½å‹
  { name: "æå³»è±ª", table: "22" },
  { name: "åŠ‰æŸå®", table: "22" },
  { name: "æ—æšåš", table: "22" },
  { name: "å¾æµ©è€•", table: "22" },
  { name: "æä¸–é´»", table: "22" },
  { name: "æ–½ç»", table: "22" },
  { name: "è³´æŸä¸", table: "22" },

  // 23è™Ÿæ¡Œ - æ–°äººå¥½å‹
  { name: "ç›§ç¿°å‡", table: "23" },
  { name: "æ—èŠ®ç«¹", table: "23" },
  { name: "å¾ç¶­è±", table: "23" },
  { name: "è¨±æ™¯ä»", table: "23" },
  { name: "æ—å­æš„", table: "23" },
  { name: "è‹—éˆºå®—", table: "23" },
  { name: "è©¹å©‰ç¾š", table: "23" },
  { name: "ç¾…å¦‚é›°", table: "23" },

  // 24è™Ÿæ¡Œ - æ–°äººåŒäº‹
  { name: "å¼µæ•¬æ˜‡", table: "24" },
  { name: "Scott", table: "24" },
  { name: "æ¥ŠCP", table: "24" },
  { name: "æ›¹å³»è±ª", table: "24" },
  { name: "Howie", table: "24" },
  { name: "æ—å®—ç·¯", table: "24" },
  { name: "Brian", table: "24" },
  { name: "åŠ‰è”¡ç¦§", table: "24" },
  { name: "Adam", table: "24" },
  { name: "å¼µé›ªç¿”", table: "24" },
  { name: "Renax", table: "24" },
  { name: "Penny", table: "24" },
  { name: "Waylen", table: "24" },
  { name: "Michael", table: "24" }
];


guests.forEach(g => g.name = g.name.trim());

function selectGuest(name) {
  const guest = guests.find(g => g.name === name);
  if (guest) showCheckinButton(guest);
}

function showCheckinButton(guest) {
  const resultEl = document.getElementById('result');
  resultEl.innerHTML = `${guest.name} æ‚¨çš„æ¡Œè™Ÿæ˜¯ï¼š${guest.table}<br/><br/>`;

  // æ”¹æˆä¸€èˆ¬æŒ‰éˆ•ï¼Œé»æ“Šæ™‚è§¸ç™¼ JS å‡½å¼
  const btn = document.createElement('button');
  btn.id = "checkinBtn";
  btn.textContent = "âœ… ç¢ºèªå ±åˆ°";
  btn.onclick = () => submitCheckin(guest.name, guest.table);
  resultEl.appendChild(btn);
}

function submitCheckin(name, table) {
  const btn = document.getElementById('checkinBtn');
  btn.disabled = true;
  btn.textContent = "è™•ç†ä¸­...";

  // ä½¿ç”¨ URLSearchParams å°è£è³‡æ–™
  const formData = new URLSearchParams();
  formData.append('name', name);
  formData.append('table', table);

  // ä½¿ç”¨ fetch ç™¼é€ POST
  fetch(webAppUrl, {
    method: 'POST',
    body: formData,
    mode: 'no-cors' // é—œéµï¼šè§£æ±ºå¤§éƒ¨åˆ† GAS çš„è·¨åŸŸå ±éŒ¯
  })
  .then(() => {
    // å› ç‚º no-cors æ¨¡å¼ä¸‹ç„¡æ³•è®€å– response å…§å®¹ï¼Œ
    // ä½†åªè¦æ²’å™´éŒ¯ï¼Œé€šå¸¸å°±æ˜¯ Google å·²ç¶“æ”¶åˆ°äº†
    alert(`ã€${name}ã€‘å ±åˆ°æˆåŠŸï¼`);
    document.getElementById('result').innerHTML = "âœ¨ å·²å®Œæˆå ±åˆ°ï¼Œè¬è¬æ‚¨çš„è’è‡¨ï¼";
    document.getElementById('queryInput').value = "";
  })
  .catch(error => {
    console.error('Error:', error);
    alert('å ±åˆ°å¤±æ•—ï¼Œè«‹æ´½ç¾å ´å·¥ä½œäººå“¡ã€‚');
    btn.disabled = false;
    btn.textContent = "âœ… ç¢ºèªå ±åˆ°";
  });
}

function lookupSeat() {
  const query = document.getElementById('queryInput').value.trim();
  const resultEl = document.getElementById('result');
  const guestSelectEl = document.getElementById('guestSelect');

  guestSelectEl.innerHTML = '';
  resultEl.textContent = '';

  if (!query) {
    resultEl.textContent = "è«‹è¼¸å…¥å§“åã€‚";
    return;
  }

  const matches = guests.filter(g => g.name.toLowerCase().includes(query.toLowerCase()));

  if (matches.length === 1) {
    showCheckinButton(matches[0]);
  } else if (matches.length > 1) {
    let selectHTML = '<label>è«‹é¸æ“‡æ‚¨çš„å…¨åï¼š</label><br/><select onchange="selectGuest(this.value)"><option value="">-- è«‹é¸æ“‡ --</option>';
    
	matches.forEach(g => {
      selectHTML += `<option value="${g.name}">${g.name}</option>`;
    });
    selectHTML += '</select>';
    guestSelectEl.innerHTML = selectHTML;
  } else {
    resultEl.textContent = "æŸ¥ç„¡è³‡æ–™ï¼Œè«‹ç¢ºèªè¼¸å…¥æ˜¯å¦æ­£ç¢ºã€‚";
  }
}

</script>

</body>
</html>
